# Mock Exam 2 - Question 10

## Question 10: Services and Network Policy Configuration

We have already deployed an application that consists of frontend, backend, and database pods in the `app-ckad` namespace. Inspect them.

Your task is to create:

1. A service `frontend-ckad-svcn` to expose the frontend pods **outside the cluster** on port **31100**
2. A service `backend-ckad-svcn` to make backend pods to be accessible **within the cluster**
3. A policy `database-ckad-netpol` to limit access to database pods **only to backend pods**

### Step 1: Inspect Existing Pods

```bash
kubectl get pods -n app-ckad --show-labels
```

### Step 2: Create Frontend Service (NodePort)

```yaml
apiVersion: v1
kind: Service
metadata:
  name: frontend-ckad-svcn
  namespace: app-ckad
spec:
  type: NodePort
  selector:
    app: frontend     # adjust to match actual labels on frontend Pods
  ports:
  - port: 80
    targetPort: 80
    nodePort: 31100   # exposed outside cluster
```

### Step 3: Create Backend Service (ClusterIP)

```yaml
apiVersion: v1
kind: Service
metadata:
  name: backend-ckad-svcn
  namespace: app-ckad
spec:
  selector:
    app: backend     # adjust to actual labels
  ports:
  - port: 80
    targetPort: 80
```

### Step 4: Create Database Network Policy

```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: db-network-policy
  namespace: app-ckad
spec:
  podSelector:
    matchLabels:
      app: database
  policyTypes:
  - Ingress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          app: backend
    ports:
    - protocol: TCP
      port: 3306
```
